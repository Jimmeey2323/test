<!DOCTYPE html>
<html>
<head>
    <title>Google Sign-In and Data Table</title>
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <meta name="google-signin-client_id" content="133015966061-gkn6j0np88ss8jjtla5bub03ig2m507b.apps.googleusercontent.com">
    <style>
        /* Add your styles here */
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <div class="g-signin2" data-onsuccess="onSignIn"></div>
    <table id="dataTable">
        <thead>
            <tr>
                <th>Member ID</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Email</th>
                <th>Membership Name</th>
                <th>Expiration Date</th>
                <th>Status</th>
                <th>Current Status</th>
                <th>Home Location</th>
                <th>Associate name</th>
                <th>Follow up date -1</th>
                <th>Followup comments</th>
                <th>Associate name</th>
                <th>Follow up date -2</th>
                <th>Followup comments</th>
                <th>Associate name</th>
                <th>Follow up date -3</th>
                <th>Followup comments</th>
                <th>Status</th>
                <th>Next Follow up date</th>
            </tr>
        </thead>
        <tbody>
            <!-- Rows will be added here dynamically -->
        </tbody>
    </table>

    <script>
        function onSignIn(googleUser) {
            var profile = googleUser.getBasicProfile();
            console.log('ID: ' + profile.getId());
            console.log('Name: ' + profile.getName());
            console.log('Image URL: ' + profile.getImageUrl());
            console.log('Email: ' + profile.getEmail());

            // Load data from Google Sheets
            loadDataFromSheets();
        }

        function initClient() {
            gapi.client.init({
                apiKey: 'AIzaSyCy9Z3Sa8KJYY4n9haAmc7QGGaTEE5X0PI',
                discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
                clientId: '133015966061-gkn6j0np88ss8jjtla5bub03ig2m507b.apps.googleusercontent.com',
                scope: 'https://www.googleapis.com/auth/spreadsheets.readonly'
            }).then(function () {
                gapi.auth2.getAuthInstance().signIn().then(function () {
                    loadDataFromSheets();
                });
            }, function(error) {
                console.log(JSON.stringify(error, null, 2));
            });
        }

        function loadDataFromSheets() {
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1WD16t5c2ro8BynlKNnLqCOxxiRgXPQpPagVTAQPjjBI',
                range: 'Expirations!A2:I'
            }).then(function(response) {
                var range = response.result;
                if (range.values.length > 0) {
                    var table = document.getElementById('dataTable').getElementsByTagName('tbody')[0];
                    for (i = 0; i < range.values.length; i++) {
                        var row = table.insertRow(-1);
                        for (j = 0; j < range.values[i].length; j++) {
                            var cell = row.insertCell(j);
                            cell.innerHTML = range.values[i][j];
                        }
                        // Add additional columns for editable fields
                        addEditableColumns(row);
                    }
                } else {
                    console.log('No data found.');
                }
            }, function(response) {
                console.log('Error: ' + response.result.error.message);
            });
        }

        function addEditableColumns(row) {
            // Add Associate name dropdown
            var cell = row.insertCell(-1);
            var select = document.createElement("select");
            var options = ["Wungsingla Wangsop", "Santhosh Kumar", "Nizam Uddin"];
            for (var i = 0; i < options.length; i++) {
                var option = document.createElement("option");
                option.value = options[i];
                option.text = options[i];
                select.appendChild(option);
            }
            cell.appendChild(select);

            // Add Follow up date -1
            cell = row.insertCell(-1);
            var input = document.createElement("input");
            input.type = "date";
            cell.appendChild(input);

            // Add Followup comments -1
            cell = row.insertCell(-1);
            var textarea = document.createElement("textarea");
            cell.appendChild(textarea);

            // Repeat for Follow up date -2, -3 and comments
            for (var i = 2; i <= 3; i++) {
                cell = row.insertCell(-1);
                select = document.createElement("select");
                for (var j = 0; j < options.length; j++) {
                    option = document.createElement("option");
                    option.value = options[j];
                    option.text = options[j];
                    select.appendChild(option);
                }
                cell.appendChild(select);

                cell = row.insertCell(-1);
                input = document.createElement("input");
                input.type = "date";
                cell.appendChild(input);

                cell = row.insertCell(-1);
                textarea = document.createElement("textarea");
                cell.appendChild(textarea);
            }

            // Add Status dropdown
            cell = row.insertCell(-1);
            select = document.createElement("select");
            var statusOptions = ["Active", "Inactive", "Expired"];
            for (var i = 0; i < statusOptions.length; i++) {
                option = document.createElement("option");
                option.value = statusOptions[i];
                option.text = statusOptions[i];
                select.appendChild(option);
            }
            cell.appendChild(select);

            // Add Next Follow up date
            cell = row.insertCell(-1);
            input = document.createElement("input");
            input.type = "date";
            cell.appendChild(input);
        }

        gapi.load('client:auth2', initClient);
    </script>
</body>
</html>
